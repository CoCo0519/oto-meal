# PPG Signal Denoising GUI Toolkit

## 概述

这是一个基于Python和Tkinter的图形化PPG信号降噪工具，类似于MATLAB的信号处理toolkit。它提供了实时参数调整和降噪效果可视化功能。

## 功能特性

### 🎯 核心功能
- **实时参数调整**: 通过滑块和控件实时调整降噪参数
- **多种降噪方法**: 支持7种不同的降噪算法
- **实时可视化**: 即时显示降噪效果和性能指标
- **频谱分析**: STFT时频分析功能
- **性能评估**: SNR、标准差减少等量化指标

### 🔧 支持的降噪方法

1. **Savitzky-Golay滤波**
   - 参数: 窗口长度 (5-101), 多项式阶数 (1-5)
   - 适用: 平滑信号，保持峰值特征

2. **中值滤波**
   - 参数: 核大小 (3-21)
   - 适用: 去除脉冲噪声

3. **维纳滤波**
   - 参数: 噪声方差 (0.01-1.0)
   - 适用: 已知噪声特性的信号

4. **小波近似**
   - 参数: 截止频率 (1-50 Hz), 滤波器阶数 (2-10)
   - 适用: 频域降噪

5. **带通滤波**
   - 参数: 低频 (0.1-5 Hz), 高频 (1-10 Hz), 阶数 (2-8)
   - 适用: 心率信号提取

6. **自适应滤波**
   - 参数: 窗口大小 (5-50)
   - 适用: 时变噪声

7. **组合滤波**
   - 参数: 两种方法的组合
   - 适用: 复杂噪声环境

## 文件说明

### 主要文件

1. **`ppg_denoising_gui.py`** - 完整版GUI工具
   - 功能最全面
   - 支持文件加载/保存
   - 多子图显示
   - 完整的参数控制

2. **`ppg_denoising_gui_simple.py`** - 简化版GUI工具
   - 轻量级版本
   - 快速演示
   - 基本功能

3. **`ppg_advanced_analysis.py`** - 原始分析脚本
   - 批量处理功能
   - 命令行界面
   - 降噪数据保存

## 使用方法

### 启动GUI工具

```bash
# 启动完整版GUI
python ppg_denoising_gui.py

# 启动简化版GUI
python ppg_denoising_gui_simple.py
```

### GUI操作步骤

1. **加载信号**
   - 点击 "Load Signal" 按钮
   - 选择PPG数据文件 (.txt格式)
   - 或使用默认演示信号

2. **选择降噪方法**
   - 在 "Denoising Method" 区域选择方法
   - 相应的参数控制面板会自动显示

3. **调整参数**
   - 使用滑块调整参数
   - 实时查看降噪效果
   - 观察性能指标变化

4. **查看结果**
   - 时域信号对比
   - 频域分析
   - STFT时频图
   - 信号差异分析

5. **保存结果**
   - 保存降噪后的信号
   - 导出分析图表
   - 导出完整报告

### 命令行使用

```bash
# 批量处理所有数据目录
python ppg_advanced_analysis.py --batch

# 处理特定目录
python ppg_advanced_analysis.py --batch 'hyx_data' 'green,ir,red'

# 处理单个文件
python ppg_advanced_analysis.py single_file.txt green
```

## 界面布局

### 完整版GUI布局

```
┌─────────────────────────────────────────────────────────┐
│                    PPG Signal Denoising Toolkit         │
├─────────────┬───────────────────────────────────────────┤
│ File Ops    │                                           │
│ Load Signal │                                           │
│ Save Denoised│            Time Domain Signal            │
│ Export      │                                           │
├─────────────┤                                           │
│ Method      │                                           │
│ ○ Savitzky  │                                           │
│ ○ Median    │                                           │
│ ○ Wiener    │                                           │
│ ○ Wavelet   │                                           │
│ ○ Bandpass  │                                           │
│ ○ Adaptive  │                                           │
│ ○ Combined  │                                           │
├─────────────┤                                           │
│ Parameters  │                                           │
│ SG Window:  │                                           │
│ [====●====] │                                           │
│ SG Poly:    │                                           │
│ [==●======] │                                           │
├─────────────┤                                           │
│ Display     │                                           │
│ ☑ Original  │                                           │
│ ☑ Denoised │                                           │
│ ☐ Spectrum │                                           │
├─────────────┤                                           │
│ Analysis    │                                           │
│ STFT Window:│                                           │
│ [====●====] │                                           │
├─────────────┤                                           │
│ Processing  │                                           │
│ Apply Denoising│                                        │
│ Reset Signal│                                           │
├─────────────┤                                           │
│ Metrics     │                                           │
│ SNR: 15.2 dB│                                           │
│ Std Dev: 0.8│                                           │
└─────────────┴───────────────────────────────────────────┘
```

### 简化版GUI布局

```
┌─────────────────────────────────────────────────────────┐
│              PPG Signal Denoising Toolkit - Demo          │
├─────────────┬───────────────────────────────────────────┤
│ Method      │                                           │
│ ○ Savitzky  │                                           │
│ ○ Median    │                                           │
│ ○ Wiener    │                                           │
│ ○ Wavelet   │                                           │
│ ○ Bandpass  │                                           │
├─────────────┤            PPG Signal Analysis            │
│ Parameters  │                                           │
│ SG Window:  │                                           │
│ [====●====] │                                           │
│ SG Poly:    │                                           │
│ [==●======] │                                           │
│ Median Kern:│                                           │
│ [==●======] │                                           │
│ Wiener Noise│                                           │
│ [==●======] │                                           │
│ Wavelet Cut │                                           │
│ [==●======] │                                           │
│ BP Low:     │                                           │
│ [==●======] │                                           │
│ BP High:    │                                           │
│ [==●======] │                                           │
├─────────────┤                                           │
│ Display     │                                           │
│ ☑ Original  │                                           │
│ ☑ Denoised │                                           │
├─────────────┤                                           │
│ Performance │                                           │
│ SNR: 15.2 dB│                                           │
│ Std Red: 0.8│                                           │
└─────────────┴───────────────────────────────────────────┘
```

## 技术特性

### 实时处理
- **即时反馈**: 参数调整后立即显示结果
- **性能监控**: 实时计算SNR、标准差等指标
- **多线程**: 避免界面冻结

### 可视化功能
- **时域分析**: 原始信号vs降噪信号对比
- **频域分析**: FFT频谱对比
- **时频分析**: STFT谱图
- **差异分析**: 噪声成分可视化

### 数据管理
- **文件支持**: 支持多种编码格式
- **批量处理**: 处理整个数据目录
- **结果保存**: 降噪数据和图表导出

## 性能指标

### 量化评估
- **信噪比 (SNR)**: 信号功率与噪声功率的比值
- **标准差减少**: 降噪前后信号标准差的变化
- **峰值保持**: 信号峰值特征的保持程度

### 实时监控
- 参数调整时实时更新指标
- 不同方法的性能对比
- 最优参数推荐

## 扩展功能

### 自定义方法
- 可以轻松添加新的降噪算法
- 支持用户自定义参数范围
- 支持方法组合和级联

### 批处理
- 支持整个数据目录的批量处理
- 自动生成对比报告
- 结果文件组织管理

## 依赖库

```python
numpy>=1.20.0
matplotlib>=3.5.0
scipy>=1.7.0
tkinter (Python内置)
pathlib (Python内置)
```

## 安装依赖

```bash
pip install numpy matplotlib scipy
```

## 使用建议

1. **参数调优**: 从默认参数开始，逐步调整
2. **方法选择**: 根据信号特性选择合适的降噪方法
3. **性能评估**: 关注SNR和标准差减少指标
4. **结果验证**: 通过频谱分析验证降噪效果
5. **数据保存**: 及时保存满意的降噪结果

## 故障排除

### 常见问题

1. **GUI无法启动**
   - 检查tkinter是否正确安装
   - 确认matplotlib后端设置

2. **信号加载失败**
   - 检查文件编码格式
   - 确认数据文件格式正确

3. **降噪效果不佳**
   - 尝试不同的降噪方法
   - 调整参数范围
   - 检查信号质量

4. **性能问题**
   - 减少信号长度
   - 降低STFT窗口大小
   - 关闭不必要的显示选项

## 更新日志

### v1.0.0 (2024-01-XX)
- 初始版本发布
- 支持7种降噪方法
- 实时参数调整
- 完整的GUI界面

### 计划功能
- 更多降噪算法
- 机器学习降噪
- 3D可视化
- 插件系统







