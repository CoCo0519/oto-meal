# 增强版小波降噪GUI使用指南

## 功能特点

### 🎯 核心功能
- **实时预览**: 原始信号、降噪信号、对比图三个视图
- **数据导出**: 支持CSV格式和图像格式导出
- **时间记录**: 精确记录处理时间
- **MATLAB兼容**: 支持所有MATLAB降噪参数

### 📊 界面布局
- **左侧控制面板**: 参数设置、文件选择、处理控制
- **右侧显示面板**: 多标签页实时预览
- **实时更新**: 处理完成后自动更新所有视图

## 使用步骤

### 1. 启动程序
```bash
python enhanced_denoise_gui.py
```

### 2. 加载数据文件
1. 点击"选择数据文件"按钮
2. 选择您的`.txt`数据文件
3. 程序会自动显示原始信号

### 3. 设置降噪参数
- **采样率**: 根据您的数据设置（默认100Hz）
- **PPG通道**: 选择green、ir或red
- **降噪方法**: wavelet或bayes
- **小波类型**: 推荐sym8（MATLAB兼容）
- **分解层数**: 推荐7层
- **阈值策略**: 推荐bayes
- **Q-Value**: 推荐0.05
- **噪声估计**: level_independent或level_dependent

### 4. 开始降噪
1. 点击"开始降噪"按钮
2. 进度条显示处理状态
3. 处理完成后自动更新所有视图

### 5. 查看结果
- **原始信号**: 查看原始数据
- **降噪信号**: 查看降噪后数据
- **对比图**: 对比原始和降噪信号
- **统计信息**: 查看详细统计报告

### 6. 导出数据
1. 点击"导出降噪数据"按钮
2. 选择导出目录
3. 程序会导出以下文件：
   - `denoised_data_[channel].csv`: 降噪数据（时间、原始、降噪、残差）
   - `denoising_config.json`: 降噪配置
   - `denoising_report.txt`: 统计报告
   - `original_[channel].png`: 原始信号图
   - `denoised_[channel].png`: 降噪信号图
   - `comparison_[channel].png`: 对比图

## 界面说明

### 控制面板
```
文件选择
├── 选择数据文件按钮
└── 文件状态显示

降噪参数
├── 采样率 (Hz)
├── PPG通道选择
├── 降噪方法选择
├── 小波类型选择
├── 分解层数设置
├── 阈值策略选择
├── Q-Value设置
└── 噪声估计方法

处理选项
├── PPG降噪复选框
└── IMU降噪复选框

处理控制
├── 开始降噪按钮
├── 进度条
├── 状态显示
└── 处理时间显示

数据导出
├── 导出降噪数据按钮
├── 保存配置按钮
└── 加载配置按钮
```

### 显示面板
```
实时预览
├── 原始信号标签页
├── 降噪信号标签页
├── 对比图标签页
└── 统计信息标签页
```

## 导出文件格式

### CSV数据格式
```csv
Time(s),Original,Denoised,Residual
0.000000,0.123456,0.123456,0.000000
0.010000,0.234567,0.234567,0.000000
...
```

### 配置文件格式
```json
{
  "fs": 100,
  "channel": "green",
  "method": "bayes",
  "wavelet": "sym8",
  "decomposition_level": 7,
  "threshold": {
    "strategy": "bayes",
    "q_value": 0.05,
    "noise_estimate": "level_independent"
  }
}
```

### 统计报告格式
```
降噪处理报告
生成时间: 2024-01-01 12:00:00
处理时间: 1.23秒
信号时长: 60.00秒
通道: GREEN
阈值: 0.123456

信号统计:
原始信号:
- 均值: 0.1234
- 标准差: 0.5678
- 峰值: 1.2345
...

降噪效果:
- 原始信噪比: 15.23 dB
- 降噪后信噪比: 18.45 dB
- 信噪比改善: 3.22 dB
- 噪声抑制率: 25.6%
```

## 技术特性

### 1. 多线程处理
- 降噪处理在后台线程执行
- 避免GUI界面冻结
- 实时显示处理进度

### 2. 实时预览
- 原始信号自动显示
- 降噪完成后自动更新所有视图
- 支持缩放和平移操作

### 3. 数据导出
- CSV格式便于Excel分析
- 高质量PNG图像
- 完整的配置和报告文件

### 4. 时间记录
- 精确到毫秒的处理时间
- 显示在界面上
- 记录在导出报告中

## 使用技巧

### 1. 参数调优
- 从MATLAB兼容配置开始
- 根据信号特性调整Q值
- 尝试不同的噪声估计方法

### 2. 结果评估
- 查看对比图评估降噪效果
- 关注统计信息中的信噪比改善
- 检查残差信号的分布

### 3. 批量处理
- 保存常用配置
- 使用配置文件快速切换参数
- 导出结果便于后续分析

## 故障排除

### 1. 文件加载失败
- 检查文件格式是否为.txt
- 确认文件路径没有特殊字符
- 检查采样率设置是否正确

### 2. 降噪处理失败
- 检查参数设置是否合理
- 确认数据长度足够进行小波分解
- 尝试降低分解层数

### 3. 导出失败
- 检查导出目录权限
- 确认有足够的磁盘空间
- 关闭可能占用文件的程序

## 性能优化

### 1. 大文件处理
- 对于长信号，考虑分段处理
- 适当降低图像分辨率
- 使用更高效的小波类型

### 2. 实时预览
- 对于超长信号，考虑显示部分数据
- 使用数据采样显示概览
- 提供缩放功能查看细节

---

**现在您可以享受完整的实时预览和数据导出功能！** 🚀

